<!DOCTYPE html>

<html>
<head> 
<title>Flight Rising Encounter Counter</title> 
<style>
div.main{width:50%; margin:auto; border-style:solid; border-width:1px; padding:40px}
</style>
</head>

<script>

function Stage() {
	this.totalEnemies = 0;
	this.enemyList = {};
	//
	this.totalItems = 0;
	this.itemList = {};
	//
	this.totalEncounters = 0;
	this.encounterList = {};
}

function Encounter(number) {
	this.encounters = number;
}

function addEnemy(stage, enemyString, number) {
	//if we've seen this enemy before, add to their count
	if (enemyString in stage.enemyList) {
		stage.enemyList[enemyString] += number;
	}
	//otherwise, make a new entry for them
	else {
		stage.enemyList[enemyString] = number;
	}
}

function addItem(stage, itemString, number) {
	//if we've seen this enemy before, add to their count
	if (itemString in stage.itemList) {
		stage.itemList[itemString] += number;
	}
	//otherwise, make a new entry for them
	else {
		stage.itemList[itemString] = number;
	}
}

function addEncounter(stage, enemyString, number) {
	//if we've seen this combo of enemies before, add to their count
	if (enemyString in stage.encounterList) {
		stage.encounterList[enemyString].encounters += number;
	}
	//otherwise, make a new entry for them
	else {
		stage.encounterList[enemyString] = new Encounter(number);
	}
}

function processEncounter(stage, enemyGang, itemDrops) {
	stage.totalEncounters += 1;
	//what is the string of this enemy group?
	let enemyString = ""; //start with a blank
	for (let i = 0; i < enemyGang.length; i++) {
		if (enemyString != "") 
			{enemyString+=", "}
		enemyString += enemyGang[i].name + " x" + enemyGang[i].number;
		addEnemy(stage,enemyGang[i].name,enemyGang[i].number);
	}
	//add this meeting to the encounter list
	addEncounter(stage, enemyString, 1);
	let encounter = stage.encounterList[enemyString];
	//add the items gotten to the encounter entry
	for (let i = 0; i < itemDrops.length; i++) {
		let itemString = itemDrops[i].name + " x" + itemDrops[i].number.toString();
		if (itemString in encounter)
			{encounter[itemString] += 1}
		else 
			{encounter[itemString] = 1}
		addItem(stage,itemDrops[i].name,itemDrops[i].number);
	}


}

const stage1 = new Stage();
//stage1.enemyList


currentGang=[];
currentGang[0]={name: "Silky Webwing", number: 14}
currentGang[1]={name: "Mith Bruiser", number: 1}

currentDrops=[];
currentDrops[0]={name: "Kokiri Sword", number: 1}
currentDrops[1]={name: "2x1 flat", number: 1}

processEncounter(stage1, currentGang, currentDrops);


//output_json = JSON.stringify(stage1)
//stage2=JSON.parse(output_json)

</script>

<body>
<br><br>


<div class="main">
<p> It's kind of working but you can only see it in the console.</p>
</div>

</body>


</html>